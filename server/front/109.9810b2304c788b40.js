"use strict";(self.webpackChunkorder_app_redesign=self.webpackChunkorder_app_redesign||[]).push([[109],{9109:(L,c,o)=>{o.r(c),o.d(c,{LoginModule:()=>b});var l=o(6019),a=o(4890),g=o(3543),u=o(7091),e=o(241),d=o(6821);let h=(()=>{class t{constructor(n,r){this._router=n,this._userService=r,this._helperService=new u.N0}canActivate(n,r){const i=localStorage.getItem(g.$.FOOD_ORDERING_AUTH_TOKEN);return!i||(this._helperService.isTokenExpired(i)?(this._userService.removeUser(),!0):(this._router.navigate([""]),!1))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(a.F0),e.LFG(d.K))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=o(4122),p=o(9225),x=o(4522),S=o(5337);function Z(t,s){if(1&t&&(e.TgZ(0,"div",14),e.TgZ(1,"span",15),e._uU(2,"*"),e.qZA(),e._uU(3),e.qZA()),2&t){const n=e.oxw();e.xp6(3),e.hij(" ",n.errorMessage," ")}}let v=(()=>{class t{constructor(n,r,i,m,k,y){this._activatedRoute=n,this._router=r,this._userService=i,this._httpClient=m,this._themeService=k,this._socialAuthService=y,this.subs=new f.Y,this._jwtHelperService=new u.N0,this.errorMessage=null}ngOnInit(){this.subs.sink=this._socialAuthService.authState.subscribe(n=>{null!==n&&null===this._userService.user&&this._httpClient.post("auth/google/callback",n).subscribe(r=>{if(r.token)try{const i=this._jwtHelperService.decodeToken(r.token);i?(localStorage.setItem(g.$.FOOD_ORDERING_AUTH_TOKEN,r.token),this._userService.user={id:i.id,firstName:i.firstName,lastName:i.lastName,email:i.email,photo:i.photo},this._router.navigate([""])):this.errorMessage="Google login failed, token not found!"}catch(i){this.errorMessage="Can't decode recieved token!"}})})}googleSignIn(){this._socialAuthService.signIn(p.tV.PROVIDER_ID)}changeTheme(){this._themeService.toggleTheme()}ngOnDestroy(){this.subs.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(a.gz),e.Y36(a.F0),e.Y36(d.K),e.Y36(x.eN),e.Y36(S.f),e.Y36(p.xE))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],decls:16,vars:1,consts:[[1,"flex","w-screen","items-center","h-screen"],[1,"flex","flex-1","items-center","justify-center","-mt-8"],[1,"flex","flex-row","bg-serapion-white","shadow-xl","rounded-md","dark:bg-serapion-black-200"],[1,"hidden","rounded-md","lg:flex","lg:flex-1","p-48","bg-serapion-blue-100","rounded-r-xl","bg-login","bg-cover","bg-no-repeat","bg-blend-soft-light","dark:bg-serapion-black-100"],[1,"flex","flex-col","text-center","items-center","justify-between","mx-16","my-8"],[1,"text-serapion-grey-100","hover:text-serapion-grey-200","cursor-pointer","dark:hover:text-serapion-white",3,"click"],[1,"fas","fa-adjust"],[1,"aspect-square","w-52","pt-10"],["src","../../../../assets/images/logo.png","alt","Serapion Logo",1,"object-cover","animate-spin-slow"],[1,"font-thin","uppercase","text-lg","tracking-widest"],[1,"w-full","mt-16"],[1,"btn","btn-primary",3,"click"],[1,"fab","fa-google","mr-1"],["class","text-center text-xs text-serapion-purple pt-2",4,"ngIf"],[1,"text-center","text-xs","text-serapion-purple","pt-2"],[1,"font-semibold"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"a",5),e.NdJ("click",function(){return r.changeTheme()}),e._UZ(6,"i",6),e.qZA(),e.TgZ(7,"div",7),e._UZ(8,"img",8),e.qZA(),e.TgZ(9,"div",9),e._uU(10," Food Ordering Service "),e.qZA(),e.TgZ(11,"div",10),e.TgZ(12,"div",11),e.NdJ("click",function(){return r.googleSignIn()}),e._UZ(13,"i",12),e._uU(14," Sign in with Google "),e.qZA(),e.qZA(),e.YNc(15,Z,4,1,"div",13),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(15),e.Q6J("ngIf",r.errorMessage))},directives:[l.O5],styles:[""]}),t})();const T=[{path:"",component:v,canActivate:[h]},{path:":token",component:v,canActivate:[h]}];let A=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[a.Bz.forChild(T)],a.Bz]}),t})(),b=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,A]]}),t})()}}]);